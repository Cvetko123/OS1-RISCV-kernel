GAS LISTING /tmp/ccGWnQM9.s 			page 1


   1              		.file	"main.cpp"
   2              		.option pic
   3              		.option norelax
   4              		.text
   5              	.Ltext0:
   6              		.align	2
   7              		.globl	main
   9              	main:
  10              	.LFB0:
  11              		.file 1 "src/main.cpp"
   1:src/main.cpp  **** 
   2:src/main.cpp  **** #include "../lib/console.h"
   3:src/main.cpp  **** #include  "../lib/hw.h"
   4:src/main.cpp  **** #include "../h/MemoryAllocator.hpp"
   5:src/main.cpp  **** 
   6:src/main.cpp  **** // uint64 pc;
   7:src/main.cpp  **** // uint64 counter=0;
   8:src/main.cpp  **** // void f() {
   9:src/main.cpp  **** //     __putc('a');
  10:src/main.cpp  **** //     __putc('\n');
  11:src/main.cpp  **** //     __asm__ volatile ("mv ra, %[destination]" :: [destination] "r" (pc));
  12:src/main.cpp  **** //     __asm__ volatile ("sd ra, 8(sp)");
  13:src/main.cpp  **** // }
  14:src/main.cpp  **** //
  15:src/main.cpp  **** //
  16:src/main.cpp  **** //
  17:src/main.cpp  **** // void dispatch() {
  18:src/main.cpp  **** //     __asm__ volatile ("mv %[ret], ra" : [ret] "=r" (pc)  );
  19:src/main.cpp  **** //     __asm__ volatile ("mv ra, %[destination]" :: [destination] "r" (&f));
  20:src/main.cpp  **** // }
  21:src/main.cpp  **** //
  22:src/main.cpp  **** //
  23:src/main.cpp  **** //
  24:src/main.cpp  **** //
  25:src/main.cpp  **** //
  26:src/main.cpp  **** // extern "C" void SuperVisorTrapHandler() {
  27:src/main.cpp  **** //     uint64 scause;
  28:src/main.cpp  **** //     __asm__ volatile ("csrr %[ret], scause" : [ret] "=r" (scause) );
  29:src/main.cpp  **** //     if (scause == (0x01UL <<63 | 0x01)) {
  30:src/main.cpp  **** //         counter++;
  31:src/main.cpp  **** //
  32:src/main.cpp  **** //         if (counter>=50) {
  33:src/main.cpp  **** //
  34:src/main.cpp  **** //             __putc('b');
  35:src/main.cpp  **** //             __putc('\n');
  36:src/main.cpp  **** //             counter=0;
  37:src/main.cpp  **** //         }
  38:src/main.cpp  **** //         __asm__ volatile ("csrc sip, 0x02");
  39:src/main.cpp  **** //     }
  40:src/main.cpp  **** //     console_handler();
  41:src/main.cpp  **** //
  42:src/main.cpp  **** // }
  43:src/main.cpp  **** 
  44:src/main.cpp  **** 
  45:src/main.cpp  **** //extern "C" void SupervisorTrap();
  46:src/main.cpp  **** 
  47:src/main.cpp  **** 
GAS LISTING /tmp/ccGWnQM9.s 			page 2


  48:src/main.cpp  **** 
  49:src/main.cpp  **** void main(){
  12              		.loc 1 49 12
  13              		.cfi_startproc
  14 0000 130101FE 		addi	sp,sp,-32
  15              		.cfi_def_cfa_offset 32
  16 0004 233C1100 		sd	ra,24(sp)
  17 0008 23388100 		sd	s0,16(sp)
  18 000c 23349100 		sd	s1,8(sp)
  19              		.cfi_offset 1, -8
  20              		.cfi_offset 8, -16
  21              		.cfi_offset 9, -24
  22 0010 13040102 		addi	s0,sp,32
  23              		.cfi_def_cfa 8, 0
  50:src/main.cpp  ****     // __asm__ volatile ("csrw stvec, %[handler]" :: [handler] "r" (SupervisorTrap));
  51:src/main.cpp  ****     // __asm__ volatile("csrs sstatus, 0x02");
  52:src/main.cpp  ****     // while (1){}
  53:src/main.cpp  ****     int* i=(int*)MemoryAllocator::Instance()->mem_alloc(sizeof(int));
  24              		.loc 1 53 5
  25              		.loc 1 53 56 is_stmt 0
  26 0014 97000000 		call	_ZN15MemoryAllocator8InstanceEv@plt
  26      E7800000 
  27              	.LVL0:
  28 001c 93054000 		li	a1,4
  29 0020 97000000 		call	_ZN15MemoryAllocator9mem_allocEm@plt
  29      E7800000 
  30              	.LVL1:
  31 0028 93040500 		mv	s1,a0
  32              	.LVL2:
  54:src/main.cpp  ****     *i=4;
  33              		.loc 1 54 5 is_stmt 1
  34              		.loc 1 54 7 is_stmt 0
  35 002c 93074000 		li	a5,4
  36 0030 2320F500 		sw	a5,0(a0)
  55:src/main.cpp  ****     __putc(*i+'0');
  37              		.loc 1 55 5 is_stmt 1
  38              		.loc 1 55 11 is_stmt 0
  39 0034 13054003 		li	a0,52
  40 0038 97000000 		call	__putc@plt
  40      E7800000 
  41              	.LVL3:
  56:src/main.cpp  ****     __putc('\n');
  42              		.loc 1 56 5 is_stmt 1
  43              		.loc 1 56 11 is_stmt 0
  44 0040 1305A000 		li	a0,10
  45 0044 97000000 		call	__putc@plt
  45      E7800000 
  46              	.LVL4:
  57:src/main.cpp  ****     MemoryAllocator::Instance()->mem_free(i);
  47              		.loc 1 57 5 is_stmt 1
  48              		.loc 1 57 42 is_stmt 0
  49 004c 97000000 		call	_ZN15MemoryAllocator8InstanceEv@plt
  49      E7800000 
  50              	.LVL5:
  51 0054 93850400 		mv	a1,s1
  52 0058 97000000 		call	_ZN15MemoryAllocator8mem_freeEPv@plt
  52      E7800000 
GAS LISTING /tmp/ccGWnQM9.s 			page 3


  53              	.LVL6:
  58:src/main.cpp  ****     char* c=(char*)MemoryAllocator::Instance()->mem_alloc(sizeof(char));
  54              		.loc 1 58 5 is_stmt 1
  55              		.loc 1 58 58 is_stmt 0
  56 0060 97000000 		call	_ZN15MemoryAllocator8InstanceEv@plt
  56      E7800000 
  57              	.LVL7:
  58 0068 93051000 		li	a1,1
  59 006c 97000000 		call	_ZN15MemoryAllocator9mem_allocEm@plt
  59      E7800000 
  60              	.LVL8:
  59:src/main.cpp  ****     *c='a';
  61              		.loc 1 59 5 is_stmt 1
  62              		.loc 1 59 7 is_stmt 0
  63 0074 93071006 		li	a5,97
  64 0078 2300F500 		sb	a5,0(a0)
  60:src/main.cpp  ****     __putc(*c);
  65              		.loc 1 60 5 is_stmt 1
  66              		.loc 1 60 11 is_stmt 0
  67 007c 13051006 		li	a0,97
  68              	.LVL9:
  69 0080 97000000 		call	__putc@plt
  69      E7800000 
  70              	.LVL10:
  61:src/main.cpp  ****     __putc('\n');
  71              		.loc 1 61 5 is_stmt 1
  72              		.loc 1 61 11 is_stmt 0
  73 0088 1305A000 		li	a0,10
  74 008c 97000000 		call	__putc@plt
  74      E7800000 
  75              	.LVL11:
  62:src/main.cpp  **** 
  63:src/main.cpp  **** 
  64:src/main.cpp  **** }...
  76              		.loc 1 64 1
  77 0094 83308101 		ld	ra,24(sp)
  78              		.cfi_restore 1
  79 0098 03340101 		ld	s0,16(sp)
  80              		.cfi_restore 8
  81              		.cfi_def_cfa 2, 32
  82 009c 83348100 		ld	s1,8(sp)
  83              		.cfi_restore 9
  84              	.LVL12:
  85 00a0 13010102 		addi	sp,sp,32
  86              		.cfi_def_cfa_offset 0
  87 00a4 67800000 		jr	ra
  88              		.cfi_endproc
  89              	.LFE0:
  91              	.Letext0:
  92              		.file 2 "src/../lib/hw.h"
  93              		.file 3 "src/../h/MemoryAllocator.hpp"
  94              		.file 4 "src/../lib/console.h"
GAS LISTING /tmp/ccGWnQM9.s 			page 4


DEFINED SYMBOLS
                            *ABS*:0000000000000000 main.cpp
     /tmp/ccGWnQM9.s:9      .text:0000000000000000 main
     /tmp/ccGWnQM9.s:13     .text:0000000000000000 .L0 
     /tmp/ccGWnQM9.s:14     .text:0000000000000000 .L0 
     /tmp/ccGWnQM9.s:15     .text:0000000000000004 .L0 
     /tmp/ccGWnQM9.s:19     .text:0000000000000010 .L0 
     /tmp/ccGWnQM9.s:20     .text:0000000000000010 .L0 
     /tmp/ccGWnQM9.s:21     .text:0000000000000010 .L0 
     /tmp/ccGWnQM9.s:23     .text:0000000000000014 .L0 
     /tmp/ccGWnQM9.s:25     .text:0000000000000014 .L0 
     /tmp/ccGWnQM9.s:26     .text:0000000000000014 .L0 
     /tmp/ccGWnQM9.s:34     .text:000000000000002c .L0 
     /tmp/ccGWnQM9.s:35     .text:000000000000002c .L0 
     /tmp/ccGWnQM9.s:38     .text:0000000000000034 .L0 
     /tmp/ccGWnQM9.s:39     .text:0000000000000034 .L0 
     /tmp/ccGWnQM9.s:43     .text:0000000000000040 .L0 
     /tmp/ccGWnQM9.s:44     .text:0000000000000040 .L0 
     /tmp/ccGWnQM9.s:48     .text:000000000000004c .L0 
     /tmp/ccGWnQM9.s:49     .text:000000000000004c .L0 
     /tmp/ccGWnQM9.s:55     .text:0000000000000060 .L0 
     /tmp/ccGWnQM9.s:56     .text:0000000000000060 .L0 
     /tmp/ccGWnQM9.s:62     .text:0000000000000074 .L0 
     /tmp/ccGWnQM9.s:63     .text:0000000000000074 .L0 
     /tmp/ccGWnQM9.s:66     .text:000000000000007c .L0 
     /tmp/ccGWnQM9.s:67     .text:000000000000007c .L0 
     /tmp/ccGWnQM9.s:72     .text:0000000000000088 .L0 
     /tmp/ccGWnQM9.s:73     .text:0000000000000088 .L0 
     /tmp/ccGWnQM9.s:77     .text:0000000000000094 .L0 
     /tmp/ccGWnQM9.s:78     .text:0000000000000098 .L0 
     /tmp/ccGWnQM9.s:80     .text:000000000000009c .L0 
     /tmp/ccGWnQM9.s:81     .text:000000000000009c .L0 
     /tmp/ccGWnQM9.s:83     .text:00000000000000a0 .L0 
     /tmp/ccGWnQM9.s:86     .text:00000000000000a4 .L0 
     /tmp/ccGWnQM9.s:88     .text:00000000000000a8 .L0 
     /tmp/ccGWnQM9.s:95     .text:00000000000000a8 .L0 
     /tmp/ccGWnQM9.s:478    .debug_abbrev:0000000000000000 .Ldebug_abbrev0
     /tmp/ccGWnQM9.s:944    .debug_str:0000000000000176 .LASF30
     /tmp/ccGWnQM9.s:954    .debug_str:0000000000000269 .LASF31
     /tmp/ccGWnQM9.s:942    .debug_str:0000000000000146 .LASF32
     /tmp/ccGWnQM9.s:5      .text:0000000000000000 .Ltext0
     /tmp/ccGWnQM9.s:91     .text:00000000000000a8 .Letext0
     /tmp/ccGWnQM9.s:906    .debug_line:0000000000000000 .Ldebug_line0
     /tmp/ccGWnQM9.s:956    .debug_str:0000000000000276 .LASF0
     /tmp/ccGWnQM9.s:936    .debug_str:000000000000011b .LASF1
     /tmp/ccGWnQM9.s:932    .debug_str:00000000000000fb .LASF2
     /tmp/ccGWnQM9.s:918    .debug_str:0000000000000045 .LASF4
     /tmp/ccGWnQM9.s:934    .debug_str:0000000000000109 .LASF3
     /tmp/ccGWnQM9.s:912    .debug_str:0000000000000023 .LASF5
     /tmp/ccGWnQM9.s:908    .debug_str:0000000000000000 .LASF6
     /tmp/ccGWnQM9.s:924    .debug_str:0000000000000098 .LASF7
     /tmp/ccGWnQM9.s:962    .debug_str:000000000000028f .LASF8
     /tmp/ccGWnQM9.s:916    .debug_str:0000000000000037 .LASF9
     /tmp/ccGWnQM9.s:984    .debug_str:0000000000000321 .LASF10
     /tmp/ccGWnQM9.s:928    .debug_str:00000000000000cb .LASF11
     /tmp/ccGWnQM9.s:974    .debug_str:00000000000002f8 .LASF12
     /tmp/ccGWnQM9.s:966    .debug_str:00000000000002b5 .LASF13
GAS LISTING /tmp/ccGWnQM9.s 			page 5


     /tmp/ccGWnQM9.s:938    .debug_str:000000000000012e .LASF14
     /tmp/ccGWnQM9.s:922    .debug_str:0000000000000082 .LASF15
     /tmp/ccGWnQM9.s:964    .debug_str:000000000000029f .LASF16
     /tmp/ccGWnQM9.s:910    .debug_str:0000000000000013 .LASF21
     /tmp/ccGWnQM9.s:914    .debug_str:000000000000002a .LASF33
     /tmp/ccGWnQM9.s:980    .debug_str:0000000000000317 .LASF17
     /tmp/ccGWnQM9.s:978    .debug_str:0000000000000312 .LASF18
     /tmp/ccGWnQM9.s:982    .debug_str:000000000000031c .LASF19
     /tmp/ccGWnQM9.s:970    .debug_str:00000000000002ce .LASF34
     /tmp/ccGWnQM9.s:926    .debug_str:00000000000000ab .LASF35
     /tmp/ccGWnQM9.s:976    .debug_str:0000000000000308 .LASF36
     /tmp/ccGWnQM9.s:972    .debug_str:00000000000002d7 .LASF37
     /tmp/ccGWnQM9.s:968    .debug_str:00000000000002c5 .LASF20
     /tmp/ccGWnQM9.s:930    .debug_str:00000000000000da .LASF22
     /tmp/ccGWnQM9.s:948    .debug_str:000000000000023f .LASF23
     /tmp/ccGWnQM9.s:940    .debug_str:000000000000013a .LASF24
     /tmp/ccGWnQM9.s:920    .debug_str:000000000000004c .LASF25
     /tmp/ccGWnQM9.s:952    .debug_str:0000000000000264 .LASF26
     /tmp/ccGWnQM9.s:950    .debug_str:0000000000000258 .LASF27
     /tmp/ccGWnQM9.s:946    .debug_str:000000000000023a .LASF28
     /tmp/ccGWnQM9.s:10     .text:0000000000000000 .LFB0
     /tmp/ccGWnQM9.s:89     .text:00000000000000a8 .LFE0
     /tmp/ccGWnQM9.s:879    .debug_loc:0000000000000000 .LLST0
     /tmp/ccGWnQM9.s:886    .debug_loc:0000000000000023 .LLST1
     /tmp/ccGWnQM9.s:27     .text:000000000000001c .LVL0
     /tmp/ccGWnQM9.s:30     .text:0000000000000028 .LVL1
     /tmp/ccGWnQM9.s:41     .text:0000000000000040 .LVL3
     /tmp/ccGWnQM9.s:46     .text:000000000000004c .LVL4
     /tmp/ccGWnQM9.s:50     .text:0000000000000054 .LVL5
     /tmp/ccGWnQM9.s:53     .text:0000000000000060 .LVL6
     /tmp/ccGWnQM9.s:57     .text:0000000000000068 .LVL7
     /tmp/ccGWnQM9.s:60     .text:0000000000000074 .LVL8
     /tmp/ccGWnQM9.s:70     .text:0000000000000088 .LVL10
     /tmp/ccGWnQM9.s:75     .text:0000000000000094 .LVL11
     /tmp/ccGWnQM9.s:958    .debug_str:0000000000000283 .LASF29
     /tmp/ccGWnQM9.s:960    .debug_str:0000000000000288 .LASF38
     /tmp/ccGWnQM9.s:32     .text:000000000000002c .LVL2
     /tmp/ccGWnQM9.s:84     .text:00000000000000a0 .LVL12
     /tmp/ccGWnQM9.s:68     .text:0000000000000080 .LVL9
     /tmp/ccGWnQM9.s:96     .debug_info:0000000000000000 .Ldebug_info0

UNDEFINED SYMBOLS
_ZN15MemoryAllocator8InstanceEv
_ZN15MemoryAllocator9mem_allocEm
__putc
_ZN15MemoryAllocator8mem_freeEPv
